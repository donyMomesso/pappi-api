components:
  schemas:

    Establishment:
      type: object
      required:
        - id
        - name
        - slug
        - main_color
        - status
        - operation_modes
        - created_at
        - updated_at
        - opening_hours
        - payment_methods
        - schedule_setting
      properties:
        id:
          type: integer
          example: 275

        name:
          type: string
          example: "Teste Integração"

        description:
          type: [string, "null"]
          example: "Sem dúvidas a melhor pizza de toda a região!"

        slug:
          type: string
          example: "teste_integracao"

        main_color:
          type: string
          pattern: "^#([A-Fa-f0-9]{6})$"
          example: "#890000"

        instagram:
          type: [string, "null"]
          example: "cardapio.web"

        whatsapp:
          type: [string, "null"]
          pattern: "^[0-9]{10,15}$"
          example: "5541996869828"

        logo_image:
          $ref: "#/components/schemas/Image"

        banner_image:
          $ref: "#/components/schemas/Image"

        status:
          type: string
          enum: [ACTIVE, INACTIVE]
          example: ACTIVE

        operation_modes:
          $ref: "#/components/schemas/OperationModes"

        custom_domain:
          type: [string, "null"]
          example: null

        created_at:
          type: string
          format: date-time
          example: "2023-06-23T11:27:53.582-03:00"

        updated_at:
          type: string
          format: date-time
          example: "2023-06-27T11:24:39.404-03:00"

        address:
          $ref: "#/components/schemas/AddressNullable"

        opening_hours:
          $ref: "#/components/schemas/OpeningHours"

        payment_methods:
          type: array
          items:
            $ref: "#/components/schemas/EstablishmentPaymentMethod"

        schedule_setting:
          $ref: "#/components/schemas/ScheduleSetting"

    Image:
      type: object
      required: [image_url, thumbnail_url]
      properties:
        image_url:
          type: string
          format: uri
        thumbnail_url:
          type: string
          format: uri

    OperationModes:
      type: object
      required: [delivery, takeout, immediate, scheduled]
      properties:
        delivery:
          type: boolean
          example: true
        takeout:
          type: boolean
          example: true
        immediate:
          type: boolean
          example: true
        scheduled:
          type: boolean
          example: true

    AddressNullable:
      type: [object, "null"]
      required: [street, neighborhood, city, state]
      properties:
        street:
          type: string
          example: "R. Júlio Azevedo"
        number:
          type: [string, "null"]
          example: "1730"
        address_block:
          type: [string, "null"]
          example: ""
        address_lot:
          type: [string, "null"]
          example: ""
        neighborhood:
          type: string
          example: "Cocó"
        complement:
          type: [string, "null"]
          example: ""
        reference:
          type: [string, "null"]
          example: null
        postal_code:
          type: [string, "null"]
          example: "60192310"
        city:
          type: string
          example: "Fortaleza"
        state:
          type: string
          example: "CE"
        latitude:
          type: [string, "null"]
          example: "-3.7448697"
        longitude:
          type: [string, "null"]
          example: "-38.4836987"

    # opening_hours tem: dias + custom_dates (objeto por data) + temporary_state + timezone
    OpeningHours:
      type: object
      required:
        - sunday
        - monday
        - tuesday
        - wednesday
        - thursday
        - friday
        - saturday
        - custom_dates
        - temporary_state
        - temporary_state_end_at
        - timezone
      properties:
        sunday:
          $ref: "#/components/schemas/TimeRanges"
        monday:
          $ref: "#/components/schemas/TimeRanges"
        tuesday:
          $ref: "#/components/schemas/TimeRanges"
        wednesday:
          $ref: "#/components/schemas/TimeRanges"
        thursday:
          $ref: "#/components/schemas/TimeRanges"
        friday:
          $ref: "#/components/schemas/TimeRanges"
        saturday:
          $ref: "#/components/schemas/TimeRanges"

        custom_dates:
          type: object
          additionalProperties:
            $ref: "#/components/schemas/CustomDateConfig"
          example:
            "2023-07-15":
              intervals: []
              observation: "Férias coletivas!"

        temporary_state:
          type: [string, "null"]
          enum: [open, closed, "null"]
          example: "closed"

        temporary_state_end_at:
          type: [string, "null"]
          format: date-time
          example: "2023-06-27T11:55:35.000-03:00"

        timezone:
          type: string
          example: "America/Sao_Paulo"

    CustomDateConfig:
      type: object
      required: [intervals, observation]
      properties:
        intervals:
          $ref: "#/components/schemas/TimeRanges"
        observation:
          type: [string, "null"]
          example: ""

    TimeRanges:
      type: array
      items:
        $ref: "#/components/schemas/TimeRange"
      description: "Se vazio, fechado."

    TimeRange:
      type: array
      minItems: 2
      maxItems: 2
      items:
        type: string
        pattern: "^([01]\\d|2[0-3]):[0-5]\\d$"
      example: ["10:00", "15:00"]

    EstablishmentPaymentMethod:
      type: object
      required:
        - payment_method
        - percentual_fee
        - fixed_fee
        - observation
        - active
        - available_on_menu
      properties:
        payment_method:
          type: string
          enum:
            - money
            - credit_card
            - debit_card
            - pix
            - pix_auto
            - meal_voucher
            - food_voucher
            - bank_transfer
            - bank_slip
            - picpay
            - debt_book
            - online_credit_card
            - ifood
            - ifood_voucher
            - food99
            - food99_voucher
          example: pix

        percentual_fee:
          type: [number, "null"]
          description: "Taxa percentual adicional (se preenchida, fixed_fee costuma ser null)."
          example: null

        fixed_fee:
          type: [number, "null"]
          description: "Taxa fixa adicional (se preenchida, percentual_fee costuma ser null)."
          example: null

        observation:
          description: "Pode ser null, string, ou objeto (no caso de pix)."
          oneOf:
            - type: "null"
            - type: string
            - $ref: "#/components/schemas/PixEstablishmentObservation"

        active:
          type: boolean
          example: true

        available_on_menu:
          type: boolean
          example: true

    PixEstablishmentObservation:
      type: object
      required: [type, key, name, observation]
      properties:
        type:
          type: string
          example: "CNPJ"
        key:
          type: string
          example: "40.834.981/0001-97"
        name:
          type: string
          example: "Cardápio Web"
        observation:
          type: [string, "null"]
          example: "Enviar o comprovante pelo WhatsApp."

    ScheduleSetting:
      type: object
      required:
        - hours_in_advance_for_scheduling
        - maximum_days_for_scheduling
        - time_interval
        - order_schedule_only_for_next_available_day
        - block_schedule_for_the_same_day
        - quantity_of_orders_per_interval
        - available_hours
      properties:
        hours_in_advance_for_scheduling:
          type: number
          example: 1

        maximum_days_for_scheduling:
          type: integer
          example: 15

        time_interval:
          type: integer
          description: "Intervalo em minutos"
          example: 30

        order_schedule_only_for_next_available_day:
          type: boolean
          example: false

        block_schedule_for_the_same_day:
          type: boolean
          example: false

        quantity_of_orders_per_interval:
          type: [integer, "null"]
          example: null

        available_hours:
          $ref: "#/components/schemas/AvailableHours"

    AvailableHours:
      type: object
      required:
        - sunday
        - monday
        - tuesday
        - wednesday
        - thursday
        - friday
        - saturday
        - custom_dates
        - temporary_state
        - temporary_state_end_at
        - timezone
      properties:
        sunday:
          $ref: "#/components/schemas/TimeRanges"
        monday:
          $ref: "#/components/schemas/TimeRanges"
        tuesday:
          $ref: "#/components/schemas/TimeRanges"
        wednesday:
          $ref: "#/components/schemas/TimeRanges"
        thursday:
          $ref: "#/components/schemas/TimeRanges"
        friday:
          $ref: "#/components/schemas/TimeRanges"
        saturday:
          $ref: "#/components/schemas/TimeRanges"

        custom_dates:
          type: [object, "null"]
          description: "Aqui veio null no exemplo"
          additionalProperties:
            $ref: "#/components/schemas/CustomDateConfig"
          example: null

        temporary_state:
          type: [string, "null"]
          enum: [open, closed, "null"]
          example: null

        temporary_state_end_at:
          type: [string, "null"]
          format: date-time
          example: null

        timezone:
          type: string
          example: "America/Sao_Paulo"
